No cheating | Medium | Misc

## Информация

> Мой друг тут учит Ocaml, а у меня что-то не получается пройти его игру... И инты у него какие-то странные...

## Подсказка
> https://dev.realworldocaml.org/runtime-memory-layout.html

## Выдать участинкам

Файл из директории [public/](public/)

## Описание

Нужно поменять с помощью CheatEngine или других подобных программ количество очков, которое нужно набрать участнику

## Решение

Запускаем файл - видим, что там аналог Flappy bird, где нужно набрать `2000` очков. Увидев, что очки увеличиваются со временем, а не за прохождение через трубы, примерно посчитаем: `3 секунды * 2000 ~= 1 час 40 минут`, что очень много. Так что решения с помощью каких-либо ботов скорее всего не будут доведены до идеала за нужное время. Заходим в что-либо для реверса - видим ужас. Так же замечаем, что задача не в категории reverse. Итого, остается не так много вещей, которые можно **удобно** сделать - в коде программы мало что сильно понятного. Смотрим на задание и догадываемся использовать Cheat Engine. Осталась одна подсказка - про целые числа. Можно [нагуглить](https://dev.realworldocaml.org/runtime-memory-layout.html), что в памяти они представляются как:

<pre>
+----------------------------+-------+
|         само число         |  тип  |
|----------------------------|-------|
|         63/31 бита         | 1 бит |
+----------------------------+-------+
</pre>

Где тип - 0, если число - указатель и 1, если число это число. Следовательно, число n в Ocaml в памяти будет представляться как `2n + 1`. 

Берем Cheat Engine, присоедняемся к процессу `game.exe` (это важно, потому что за отображение окна командной строки отвечает другой процесс) и ищем наш счет в памяти. Видим, что значения постоянно меняются и вообще понять где нон мы не можем. Попробуем единственное другое число в игре - тот счет, которого надо достичь. Он равен `2000`, значит искать нам надо `2000 * 2 + 1 = 4001`. Он уже спокойно находится и меняется на маленькое нечетное число, которое мы легко набираем рукаим и получаем флаг.

## Флаг

`ctf{zh1t3ly_c1tbl_v1ruba1t3_sv0y_lo9CiaR57}`

