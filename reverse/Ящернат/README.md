# Ящернат | medium | rev

## Информация
Упс... Ты не ходил на пары, а участвовал в CTF. И вот настал момент, когда тебя вызвали в деканат. Сможешь ли ты придумать причину пропуска, которая оправдает тебя? Не забудь обернуть в ctf{}

## Выдать участникам
Выдать [main.exe](public/main.exe) из директории [public/](public/)

## Описание
Этот exe написан на python. Надо извлечь байт-код, получить исходный код и разревёрсить.

## Решение
Перед нами main.exe, написанный на python. Это можно понять, например, по строкам (команда strings или что-то ещё). Извлекаем байт-код с помощью, например, этого [скрипта](https://github.com/extremecoders-re/pyinstxtractor). Появится папка main.exe_extracted. В ней будет файл main.pyc - байт-код, полученный из исходного кода, который написал [разработчик](https://youtu.be/dQw4w9WgXcQ?si=c1ot6Klm8LLyZ-DS). Из байт-кода можно получить исходный, например, с помощью этого [сайта](https://pylingual.io/). Начинаем исследовать [исходный код](src/main.py). Видим, что сначала пользователь вводит пароль. Сначала символы в пароле переставляются в соотвествии со списком ind, и возвращается список чисел - кодов символов пароля. После этого происходит посимвольный [xor](https://ru.wikipedia.org/wiki/%D0%98%D1%81%D0%BA%D0%BB%D1%8E%D1%87%D0%B0%D1%8E%D1%89%D0%B5%D0%B5_%C2%AB%D0%B8%D0%BB%D0%B8%C2%BB) с числами из списка nums (там шестадцатеричные числа), и возвращается список чисел. На третьем шаге числа превращаются в символы, от каждого символа считается md5-хэш и записывается в список current. В конце сравниваются список current и эталонный список correct. Если они равны, всё гуд. Решение [здесь](solve/solve.py)

## Hints
Этот main.exe написан на python. Возможно, стоит попытаться извлечь его байт-код и восстановить исходный код?

## Флаг
`ctf{My_cat_has_s1gned_up_f0r_a_Y0GA_c0urs3}`