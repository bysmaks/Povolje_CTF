# Страшная весточка | easy | stego

## Информация
Вы долгое время играли ctf и не ходили на пары. Поэтому вас отчислили, и вам пришла повестка. Друг узнал о вашей проблеме и готов помочь. Сможете ли вы избежать наказания? Не забудьте обернуть результат в ctf{}

## Выдать участникам
Выдать картинку [poslanie.docx](public/poslanie.docx) и [vestochka.jpg](public/vestochka.jpg) из директории [public/](public/)

## Описание
Необходимо извлечь строку из повестки, записанную с помощью lsb в зелёный канал. Далее необходимо [poslanie.docx](public/poslanie.docx) открыть архиватором и найти там картинку, размер которой необходимо запатчить. В конце надо поксорить строку и числа из картинки.

## Решение
Открываем [послание от друга](public/poslanie.docx). Понимаем, что в этом послании спрятана инструкция. Открываем docx с помощью архиватора, находим [картинку](solve/1.png). Понимаем, что её фактический размер больше отображаемого. Значит, надо увеличить её высоту. Для этого изучаем структуру png, например, с помощью [этой статьи](https://habr.com/ru/articles/130472/). Понимаем, что нам нужен чанк IHDR. В нём первые 4 байта - ширина, вторые 4 байта - высота. Открываем картинку в любом hex-редакторе, например, в [этом](https://hexed.it/). Находим там нужные байты, меняем на большее значение так, чтобы увидеть числа внизу. [скрин](solve/2.png). Получили числа. Теперь надо получить строку из повестки. Какой известный способ спрятать информацию в картинку? Конечно же [lsb](https://ru.wikipedia.org/wiki/%D0%A1%D1%82%D0%B5%D0%B3%D0%B0%D0%BD%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%8F#%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_LSB). Пишем [скрипт](solve/solve.py) и извлекаем строку "info_that_will_help_you". Далее ксорим и получаем флаг.
[скрипт](solve/solve.py)

## Hints
LSB в повестке

## Флаг
`ctf{CTFease_is_your_desease}`