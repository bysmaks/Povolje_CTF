# web | Сложный пароль | easy

## Информация
> Наши агенты внедрились в ряды хакерской группировки, которая разрабатывала секретный форум для обмена информацией и координации атак. Но операция пошла не по плану — личность агентов была раскрыта, и они были вынуждены бежать, унося с собой лишь один файл. Теперь ваша цель — проникнуть на их сайт и выяснить, какие у них ближайшие планы. Удачи!

## Деплой
```bash
cd deploy
docker-compose up --build -d
```

## Выдать участникам
IP:PORT сервера
и файл [login.php](public/login.php)

## Описание
В коде на php реализовано неправильное сравнение, поэтому проверку на пароль можно обойти.

## Решение
Внимательно посмотрим кусок кода, который отвечает за проверку имени и пароля пользователя.
```php
if (($username === 'admin' && md5($password) == "0e123456789101112131415161718192") || ($username === 'test' && md5($password) == '098f6bcd4621d373cade4e832627b4f6')) {
        $_SESSION['logged_in'] = true;
        $_SESSION['username'] = $username;
        header("Location: success.php");
    } else {
        header("Location: error.php");
        exit();
    }
```
Мы успешно войдем на сайт, если имя пользователя `admin` и хэш пароля `0e123456789101112131415161718192`, либо `test` и хэш `098f6bcd4621d373cade4e832627b4f6`. Попробуем поискать в [радужных таблицах](https://crackstation.net/) представленные пароли. Нашелся только пароль от пользователя `test`. Попробуем войти от его имени, но ничего полезного не находим.

Замечаем, что при сравнении имени пользователя используют 3 знака `=`, а пароля лишь 2, возможно они чем-то отличаются. Погуглив, находим вот [такую вещь](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/php-tricks-esp#:~:text=A%20string%20starting%20with%20%220e%22%20and%20followed%20by%20anything%20will%20be%20equals%20to%200), про сравнения в php. Строка с `0exxxx == 0` будет правдой, поэтому нам надо найти любой хеш, который тоже будет начинаться с  `0exxx`.
Пример: md5(GGHMVOE) = 0e362766013028313274586933780773, больше примеро [тут](https://github.com/spaze/hashes/blob/master/md5.md)
Попробуем войти с кредами admin:GGHMVOE, получаем флаг.

## Флаг

`ctf{h4ck1ng_h4ck3rs_1s_f4n}`
